
Read problems statements in Hindi, Mandarin Chinese, Russian, Vietnamese and Bengali as well.
Monisha likes to paint. She has painted NN paintings (numbered 11 through N) and wants to choose some subset of these paintings for an exhibition. For each valid i, the i-th painting has beauty bi and the probability that it will be displayed at the exhibition is pi. Each painting is chosen or excluded from the exhibition independently randomly.
The beauty of the resulting exhibition is the bitwise XOR of the beauties of all displayed paintings. If no paintings are displayed, the XOR is 0.
Monisha wants to find out how beautiful her exhibition is going to be. Help her compute the expected value of the beauty of the exhibition.
Input

The first line of the input contains a single integer T denoting the number of test cases. The description of T test cases follows.
The first line of each test case contains a single integer N.
The second line contains N space-separated integers b1,b2,…,bN.
The third line contains N space-separated real numbers p1,p2,…,pN. Each of these numbers is given with at most five digits after the decimal point.

Output
For each test case, print a single line containing one real number — the expected beauty of the exhibition. Your answer will be considered correct if its absolute or relative error does not exceed 10−6.
Constraints

1≤N≤105
0≤bi≤109 for each valid i
0≤pi≤1 for each valid i
the sum of N over all test cases does not exceed 4⋅105


                        Sample Input 1
                        





2
3
5 6 2
1.0 0.0 0.5
4
2 2 2 2
0.5 0.5 0.5 0.5



                        Sample Output 1
                        





6.000000000000000
1.000000000000000


Explanation
Example case 1: The first painting must be displayed at the exhibition, the second one must be excluded. If the third painting is displayed (with probability 0.5), the beauty is 5⊕2=7; if it is excluded (with probability 0.5), the beauty is 5. The expected beauty is 0.5⋅5+0.5⋅7=6.
Example case 2: If there is an odd number of paintings at the exhibition, the beauty is 2; this has a probability of 0.5. If there is an even number of paintings, the beauty is 0 (with probability 0.5), so the expected beauty is 0.5⋅0+0.5⋅2=1.



Author:
6★anachor


Editorial:
https://discuss.codechef.com/problems/EXPXOR


Tags:

               
                 Bitwise Operation, Expected Value
                 
                     
                     Mathematics, Bit Manipulation, Probability
                 
               
             
             



                        Difficulty Rating:
                    

2363


Date Added:
13-05-2019


Time Limit:
1 secs


Source Limit:
50000 Bytes


Languages:
PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM





Submit

