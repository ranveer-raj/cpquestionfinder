
Read problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.
Kuroni is not only a great programmer, but also a successful farmer. He has already built NN cowsheds for his cows (numbered 11 through NN) and equipped them with air conditioners, refrigerators, etc. Despite these facilities and high quality food, the cows do not seem to be happy. Through research, Kuroni figured out that cows also need the Internet to communicate and chit-chat with each other. 
Kuroni decided to build a LAN system of connections between his cowsheds. Initially, no connections between the cowsheds exist. Then, for QQ days (numbered 11 through QQ), Kuroni adds some direct connections without removing any previously added connections. For each valid ii, on the ii-th day, Kuroni adds direct bidirectional connections between pairs of cowsheds (Li,Ri),(Li+1,Ri−1),…,(Ri,Li)(Li,Ri),(Li+1,Ri−1),…,(Ri,Li), i.e. (Li+k,Ri−k)(Li+k,Ri−k) for each 0≤k≤Ri−Li0≤k≤Ri−Li. (There may be multiple connections between some pairs of cowsheds. A cowshed may also be connected with itself.)
Two cowsheds are in the same group if they can communicate with each other either directly or indirectly ― through connections with some other cowsheds. At the end of each day, tell Kuroni the number of groups of cowsheds that currently exist.
Input

The first line of the input contains two space-separated integers NN and QQ.
QQ lines follow. For each valid ii, the ii-th of these lines contains two space-separated integers LiLi and RiRi.

Output
Print QQ lines. For each valid ii, the ii-th of these lines should contain a single integer ― the number of groups at the end of the ii-th day.
Constraints

2≤N≤2⋅1052≤N≤2⋅105
1≤Q≤5⋅1051≤Q≤5⋅105
1≤Li≤Ri≤N1≤Li≤Ri≤N for each valid ii

Subtasks
Subtask #1 (50 points): N,Q≤5,000N,Q≤5,000
Subtask #2 (50 points): original constraints
Example Input 1
5 3
3 5
4 5
2 3

Example Output 1
4
3
2

Example Input 2
7 3
3 5
3 7
1 7

Example Output 2
6
4
2

Explanation
Example case 1: On the first, second and third day, one connection between cowsheds (3,5)(3,5), (4,5)(4,5) and (2,3)(2,3) is added, respectively.
Example case 2:

On the first day, only one connection between cowsheds (3,5)(3,5) is added, so the number of group is 66.
On the second day, connections between pairs of cowsheds (3,7)(3,7) and (4,6)(4,6) are added, so we now have four groups {1}{1}, {2}{2}, {3,5,7}{3,5,7} and {4,6}{4,6}.
On the third day, connections between pairs of cowsheds (1,7)(1,7), (2,6)(2,6) and (3,5)(3,5) are added, so at the end, there are only two groups {1,3,5,7}{1,3,5,7} and {2,4,6}{2,4,6}.




Author:
6★rhymastic


Editorial:
https://discuss.codechef.com/problems/COWSHEDS


Tags:

               
                 Disjoint Set Union, Segment Trees, Hashing, Binary Search
                 
                     
                     Advanced Data Structures, Advanced Tree Structures, Algorithms, Searching
                 
               
             
             



                        Difficulty Rating:
                    

2966


Date Added:
25-06-2020


Time Limit:
4 secs


Source Limit:
50000 Bytes


Languages:
CPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM





Submit

